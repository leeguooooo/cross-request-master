# Cross Request Master

一个专为 YApi 接口管理平台定制的 Chrome 扩展，用于绕过 CORS 限制并自动生成 cURL 命令。

## 功能特性

- ✅ 支持跨域请求，绕过浏览器 CORS 限制
- ✅ **自动生成 cURL 命令**，一键复制分享
- ✅ **页面内实时显示**，无需打开扩展弹窗
- ✅ 域名白名单管理，提高安全性
- ✅ 专为 YApi 接口测试优化
- ✅ 已迁移至 Chrome Manifest V3

![cURL 生成效果](./images/curl-generation-demo-new.png)

## 安装方法

1. 下载此仓库
2. 打开 Chrome 浏览器，进入 `chrome://extensions/`
3. 开启"开发者模式"（右上角开关）
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹

## 使用方法

1. 安装扩展后，在 YApi 接口页面正常发送请求
2. 扩展会自动在页面右上角显示对应的 cURL 命令
3. 点击"复制"按钮即可复制完整的 cURL 命令

## 安全注意事项

⚠️ **重要提示**：
- 仅在开发环境使用，请勿在生产环境使用
- 建议使用域名白名单，避免允许所有域名
- 不要在银行、支付等敏感网站启用此扩展

## 更新日志

### v4.4.5 (2025-01-16)
- 🐛 修复 cURL 弹窗不显示问题
  - 修复 content script 中 this 上下文丢失的问题
  - 改进事件监听器的调用方式，确保函数正确执行
  - 添加详细的调试日志帮助排查问题

### v4.4.4 (2025-01-16)
- 🐛 修复 Chrome runtime 消息传递错误
  - 解决网页脚本无法直接调用 chrome.runtime.sendMessage() 的问题
  - 重构消息通信架构：网页脚本 → DOM 事件 → content script → background script
  - 确保扩展功能在各种网页环境下都能正常工作

### v4.4.3 (2025-01-16)
- 🐛 修复永久关闭按钮无响应问题
  - 修复事件监听器在 DOM 元素重新创建时丢失的问题
  - 添加事件重新绑定机制确保按钮功能正常
  - 改进事件处理的稳定性和调试信息

### v4.4.2 (2025-01-16)
- 🐛 修复消息端口关闭错误
  - 解决 "The message port closed before a response was received" 错误
  - 改进 Chrome extension 消息通信的错误处理
  - 添加异步操作超时处理和错误恢复机制
  - 优化用户界面响应性

### v4.4.1 (2025-01-16)
- ✨ 新增 cURL 弹窗控制功能
  - 在 cURL 弹窗中添加"永久关闭"按钮
  - 在扩展弹窗中添加重新启用 cURL 弹窗的选项
  - 用户可以根据需要灵活控制 cURL 命令的显示
- 🎯 优化用户体验
  - 用户可以永久关闭不需要的 cURL 弹窗提醒
  - 需要时可以随时通过扩展弹窗重新启用
  - 设置状态持久化保存，重启浏览器后依然有效

### v4.4.0 (2025-01-16)
- 🐛 修复 Extension context invalidated 错误
  - 完全移除 localStorage 相关功能，避免存储访问冲突
  - 简化扩展功能，专注于核心跨域请求处理
  - 移除请求历史记录功能，减少内存占用和 Context 失效风险
- 🎯 简化用户界面
  - 弹窗界面移除复杂的历史记录展示
  - 专注于实时的 cURL 命令显示功能
  - 优化页面内弹窗体验
- ⚙️ 代码优化
  - 移除大量历史记录相关代码
  - 减少后台脚本复杂度
  - 提升扩展稳定性和性能

### v4.3.0 (2025-07-16)
- 🎯 简化扩展功能
  - 移除复杂的域名白名单管理界面
  - 强制允许所有域名，简化用户操作
  - 弹窗界面专注于请求历史和 cURL 生成功能
- 🚀 优化用户体验
  - 移除不必要的调试信息显示
  - 清理冗余的 DOM 元素和事件处理
  - 简化弹窗标题和提示文案
- ⚙️ 代码优化
  - 移除域名验证和管理相关代码
  - 精简 popup.js 文件大小
  - 优化后台脚本逻辑

### v4.2.0 (2025-07-16)
- 🐛 修复 YApi 错误处理和响应格式问题
  - 解决 "Cannot read properties of undefined" 错误
  - 确保所有响应对象都包含必需的 status、statusText 等属性
  - 网络错误使用 503 状态码，避免显示为空
  - 错误响应不再包含虚构的响应体
- 🎨 添加用户友好的错误提示界面
  - 页面顶部显示错误提示框
  - 支持多种错误类型的详细提示信息
  - 5秒后自动消失
- 📝 支持 application/x-www-form-urlencoded 请求格式
  - 根据 Content-Type 自动选择请求体序列化方式
  - form-urlencoded 使用 URLSearchParams 进行编码
  - 保持 JSON 格式作为默认选项

### v4.1.0 (2025-07-15)
- 🚀 新增 cURL 命令自动生成功能
- 📱 页面内实时显示 cURL 命令弹窗
- 📋 完整的请求历史管理
- 🔄 自动捕获请求头和认证信息
- 📤 一键复制分享功能

### v4.0.2 (2025-07-15)
- 📖 更新 README 为 Chrome 扩展专版
- 📋 添加详细的跨域问题解决说明
- 🛡️ 增强安全提醒和最佳实践说明

### v4.0.1 (2025-06-26)
- 迁移到 Manifest V3
- 添加域名白名单管理功能
- 重构代码以提高安全性

## 许可证

MIT License